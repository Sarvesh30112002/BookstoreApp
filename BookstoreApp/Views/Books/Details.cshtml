@model BookstoreApp.Models.Book

@{
    ViewData["Title"] = "Book Details";
}

<h2>Book Details</h2>

<hr class="border-light opacity-25" />

<div class="card">
    <div class="card-body">

        <!-- Display book information -->
        <dl class="row">

            <!-- Title -->
            <dt class="col-sm-2">Title</dt>
            <dd class="col-sm-10">@Model.Title</dd>

            <!-- Author -->
            <dt class="col-sm-2">Author</dt>
            <dd class="col-sm-10">@Model.Author</dd>

            <!-- Genre -->
            <dt class="col-sm-2">Genre</dt>
            <dd class="col-sm-10">@Model.Genre</dd>

            <!-- Price -->
            <dt class="col-sm-2">Price</dt>
            <dd class="col-sm-10">@Model.Price</dd>

        </dl>

    </div>
</div>

<!-- Navigation buttons -->
<div class="mt-3">
    <a asp-action="Edit"
       asp-route-id="@Model.Id"
       class="btn btn-primary btn-lg me-2">
        Edit
    </a>

    <a asp-action="Index"
       class="btn btn-secondary btn-lg">
        Back to list
    </a>
</div>

<!-- ============================= -->
<!-- AI summary section (LAST)     -->
<!-- ============================= -->

<hr class="border-light opacity-25 mt-4" />

<h5 class="mt-3">AI Summary</h5>

<button id="loadSummaryBtn" class="btn btn-outline-warning mb-3">
    Generate AI summary
</button>

<div id="aiSummaryBox" class="alert alert-dark d-none"></div>

@section Scripts
{
    <script>
        document.getElementById("loadSummaryBtn")
            .addEventListener("click", async function () {

                const box = document.getElementById("aiSummaryBox");
                box.classList.remove("d-none");
                box.innerText = "Generating summary...";

                const response = await fetch('/Books/GetAiSummary?id=@Model.Id');

                const data = await response.json();

                box.innerText = data.summary;
            });
    </script>
}
